{"children":[{"children":[],"uri":"https://www.notion.so/21d548da58634fcf80216c7d32c07c80","type":"heading","createdTime":1616989511755,"lastEditedTime":1616992860000,"title":[["Investigating the mystery PDF File"]],"depth":2},{"children":[{"children":[],"uri":"https://www.notion.so/217d1ee6a5ff47aa9518b9cd4305949d","type":"file","createdTime":1616989745843,"lastEditedTime":1616991240000,"fileId":"1265e1d3-f480-4881-a1f6-b188cdc8701e","title":"chicken.pdf","size":"50.7KB","source":"https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F1265e1d3-f480-4881-a1f6-b188cdc8701e%2Fchicken.pdf?table=block&id=217d1ee6-a5ff-47aa-9518-b9cd4305949d"},{"children":[],"uri":"https://www.notion.so/43fccf1ddc464ccba43451e940f63086","type":"image","createdTime":1616990040000,"lastEditedTime":1616993400000,"source":"https://i.imgur.com/jBSJVNH.png?width=960","caption":[],"width":960,"height":-1,"fullWidth":false,"pageWidth":false,"aspectRatio":0.6045958795562599,"preserveScale":true}],"uri":"https://www.notion.so/55f09c22fec84586a5f375b7a9d85802","type":"bulleted_list","createdTime":1616989511755,"lastEditedTime":1616991240000,"title":[["We're given a modified PDF file of the infamous research paper, \"Chicken Chicken Chicken: Chicken Chicken\", by Doug Zongker at the University of Washington."]]},{"children":[{"children":[],"uri":"https://www.notion.so/557eac2c905049c5ae47d198f6e80445","type":"image","createdTime":1616989636289,"lastEditedTime":1616990040000,"source":"https://i.imgur.com/bE2dmRu.png?width=1344","caption":[],"width":1344,"height":-1,"fullWidth":false,"pageWidth":false,"aspectRatio":-1,"preserveScale":true}],"uri":"https://www.notion.so/6b3d506419e04180a2edef5d85ef4a86","type":"bulleted_list","createdTime":1616989511756,"lastEditedTime":1616990580000,"title":[["Since we know this is a published research paper, we can download a copy of the "],["original PDF file",[["a","https://isotropic.org/papers/chicken.pdf"]]],[" and compare the two for any difference:"]]},{"children":[{"children":[],"uri":"https://www.notion.so/cfcd83ebb4a44fbab20229b8da9424af","type":"text","createdTime":1616990100000,"lastEditedTime":1616998860000,"title":[["$ hexdump -C chicken.pdf | grep 7z -A 11",[["c",null]]]]},{"children":[],"uri":"https://www.notion.so/9462a25e8ff94e0fbf1a52183ef31d70","type":"code","createdTime":1616990100000,"lastEditedTime":1616993340000,"title":[["00001980  0d 0a 37 7a bc af 27 1c  00 04 2b 65 00 6c 30 00  |..7z..'...+e.l0.|\n00001990  00 00 00 00 00 00 6a 00  00 00 00 00 00 00 4c 6a  |......j.......Lj|\n000019a0  b9 1e 0c fd be 4f 3b 93  39 58 52 bd 23 ea 0b 2d  |.....O;.9XR.#..-|\n000019b0  8d d1 a2 79 55 0b d8 05  68 43 0d ae 06 d5 2d f8  |...yU...hC....-.|\n000019c0  25 ff b4 16 8d 21 3b 88  16 35 44 69 6d 5c 0e 59  |%....!;..5Dim\\.Y|\n000019d0  a7 b3 01 04 06 00 01 09  30 00 07 0b 01 00 02 24  |........0......$|\n000019e0  06 f1 07 01 0a 53 07 56  f2 43 9d 21 42 28 ae 21  |.....S.V.C.!B(.!|\n000019f0  21 01 00 01 00 0c 29 25  00 08 0a 01 4e 5d 1c 8e  |!.....)%....N]..|\n00001a00  00 00 05 01 19 09 00 00  00 00 00 00 00 00 00 11  |................|\n00001a10  0f 00 73 00 65 00 63 00  72 00 65 00 74 00 00 00  |..s.e.c.r.e.t...|\n00001a20  19 04 00 00 00 00 14 0a  01 00 80 33 4a 2c b7 1d  |...........3J,..|\n00001a30  d7 01 15 06 01 00 20 80  a4 81 00 00 0a 65 6e 64  |...... ......end|"]],"language":"Plain Text","wrap":false}],"uri":"https://www.notion.so/5f00af15578549948275f5d2f5391191","type":"bulleted_list","createdTime":1616989511756,"lastEditedTime":1616992680000,"title":[["We see that at around line 202, there is an extra OpenAction object inserted into the document, with a data stream beginning with "],["7z",[["c",null]]],[":"]]},{"children":[{"children":[],"uri":"https://www.notion.so/5d466c0ff96f4e81a1f09c5c7cbffa9a","type":"bookmark","createdTime":1616990280000,"lastEditedTime":1616990280000,"link":"https://en.wikipedia.org/wiki/List_of_file_signatures","title":"List of file signatures - Wikipedia","description":"Many file formats are not intended to be read as text. If such a file is accidentally viewed as a text file, its contents will be unintelligible. However, sometimes the file signature can be recognizable when interpreted as text.","icon":"https://en.wikipedia.org/static/favicon/wikipedia.ico"},{"children":[],"uri":"https://www.notion.so/145d025ba3444c639c751088b5ef9186","type":"image","createdTime":1616990280000,"lastEditedTime":1616993460000,"source":"https://i.imgur.com/99riFle.png?width=672","caption":[],"width":672,"height":75,"fullWidth":false,"pageWidth":false,"aspectRatio":0.10885341074020319,"preserveScale":true}],"uri":"https://www.notion.so/7735004a2de846b3b21ebb65a4b69eac","type":"bulleted_list","createdTime":1616989511756,"lastEditedTime":1616999100000,"title":[["The data stream starts with the 7z magic bytes, confirming that it is indeed a 7z file:"]]},{"children":[{"children":[],"uri":"https://www.notion.so/3a8a66306bf84eeb9aefcb010f29c7b5","type":"text","createdTime":1616990760000,"lastEditedTime":1616998860000,"title":[["$ hexdump -C chicken.pdf | grep 7z -A 11 | cut -d ' ' -f3- | rev | cut -d ' ' -f3- | rev > chicken.hex",[["c",null]]]]},{"children":[],"uri":"https://www.notion.so/e6264ec2005c4309951f3ede470c29b5","type":"code","createdTime":1616990760000,"lastEditedTime":1616991000000,"title":[["0d 0a",[["s",null]]],[" 37 7a bc af 27 1c 00 04 2b 65 00 6c 30 00\n00 00 00 00 00 00 6a 00 00 00 00 00 00 00 4c 6a\nb9 1e 0c fd be 4f 3b 93 39 58 52 bd 23 ea 0b 2d\n8d d1 a2 79 55 0b d8 05 68 43 0d ae 06 d5 2d f8\n25 ff b4 16 8d 21 3b 88 16 35 44 69 6d 5c 0e 59\na7 b3 01 04 06 00 01 09 30 00 07 0b 01 00 02 24\n06 f1 07 01 0a 53 07 56 f2 43 9d 21 42 28 ae 21\n21 01 00 01 00 0c 29 25 00 08 0a 01 4e 5d 1c 8e\n00 00 05 01 19 09 00 00 00 00 00 00 00 00 00 11\n0f 00 73 00 65 00 63 00 72 00 65 00 74 00 00 00\n19 04 00 00 00 00 14 0a 01 00 80 33 4a 2c b7 1d\nd7 01 15 06 01 00 20 80 a4 81 00 00 "],["0a 65 6e 64",[["s",null]]]],"language":"Plain Text","wrap":false}],"uri":"https://www.notion.so/a21f5d63b13a4d6a864e9f473b14ed73","type":"bulleted_list","createdTime":1616989511756,"lastEditedTime":1616999100000,"title":[["Let's extract the stream with a bit of Bash-fu to a "],["chicken.hex",[["c",null]]],[" file:"]]},{"children":[],"uri":"https://www.notion.so/c0fd12bb74fb4065bcf1e2382717440b","type":"bulleted_list","createdTime":1616989511757,"lastEditedTime":1616992200000,"title":[["From reading the "],["technical specifications",[["a","https://www.7-zip.org/recover.html"]]],[" of the 7z file format, we know the file has to begin with "],["37 7A BC AF 27 1C",[["c",null]]],[" and end with "],["00 00",[["c",null]]],[". Therefore, we can trim off the starting "],["0D 0A",[["c",null]]],[" and the ending "],["0A 65 6E 64",[["c",null]]],[" bytes, as they are not a part of the file."]]},{"children":[{"children":[],"uri":"https://www.notion.so/dc283ba5164549809b25cb2376c6b567","type":"text","createdTime":1616991060000,"lastEditedTime":1616991060000,"title":[["$ xxd -r -p chicken.hex chicken.7z",[["c",null]]]]}],"uri":"https://www.notion.so/1546543944084d21881905499ad13ced","type":"bulleted_list","createdTime":1616989511757,"lastEditedTime":1616992500000,"title":[["Convert the hex dump to a 7z file:"]]},{"children":[],"uri":"https://www.notion.so/a0775e81ae534ac6a4c6202d5063add5","type":"heading","createdTime":1616989511757,"lastEditedTime":1616992860000,"title":[["Extracting and cracking 7z password hash with John the Ripper"]],"depth":2},{"children":[{"children":[],"uri":"https://www.notion.so/93170cba9a9f4064ae27b3c60faff6be","type":"text","createdTime":1616991180000,"lastEditedTime":1616991480000,"title":[["$ 7z x chicken.7z",[["c",null]]]]},{"children":[],"uri":"https://www.notion.so/cc018051497a467b9108fd8d0e285dd2","type":"code","createdTime":1616991480000,"lastEditedTime":1616992440000,"title":[["7-Zip [64] 17.03 : Copyright (c) 1999-2020 Igor Pavlov : 2017-08-28\np7zip Version 17.03 (locale=en_AU.UTF-8,Utf16=on,HugeFiles=on,64 bits,8 CPUs x64)\n\nScanning the drive for archives:\n1 file, 186 bytes (1 KiB)\n\nExtracting archive: chicken.7z\n--\nPath = chicken.7z\nType = 7z\nPhysical Size = 186\nHeaders Size = 138\nMethod = LZMA2:12 7zAES\nSolid = -\nBlocks = 1\n\nEnter password (will not be echoed): _"]],"language":"Plain Text","wrap":false}],"uri":"https://www.notion.so/3e11d03573cc42abb0b88fc4e6ac06d6","type":"bulleted_list","createdTime":1616991180000,"lastEditedTime":1616991480000,"title":[["Upon trying to extract the 7z file, we're greeted with a password prompt:"]]},{"children":[{"children":[],"uri":"https://www.notion.so/c957100b10104bf0ae31e90de30fc9a3","type":"text","createdTime":1616991180000,"lastEditedTime":1616991600000,"title":[["$ 7z2john ./chicken.7z > chicken.hash",[["c",null]]]]},{"children":[],"uri":"https://www.notion.so/295393d1575e4b8ead58af345992a506","type":"code","createdTime":1616991600000,"lastEditedTime":1616991660000,"title":[["chicken.7z:$7z$2$19$0$$8$56f2439d214228ae0000000000000000$2384223566$48$41$0cfdbe4f3b93395852bd23ea0b2d8dd1a279550bd80568430dae06d52df825ffb4168d213b88163544696d5c0e59a7b3$37$00"]],"language":"Plain Text","wrap":false}],"uri":"https://www.notion.so/babb4d1372d24060be27b7335b2eca0e","type":"bulleted_list","createdTime":1616989511757,"lastEditedTime":1616991600000,"title":[["We can obtain the password hash with "],["7z2john",[["c",null]]],[":"]]},{"children":[{"children":[],"uri":"https://www.notion.so/cf7008c3d8944ec094fed4dee67e3450","type":"text","createdTime":1616991600000,"lastEditedTime":1616994000000,"title":[["$ john chicken.hash --wordlist=rockyou.txt --format=7z-opencl",[["c",null]]]]},{"children":[],"uri":"https://www.notion.so/f0a536631c19422388ae893d75a4b530","type":"code","createdTime":1616991660000,"lastEditedTime":1616992620000,"title":[["Device 2@arch-zippy: GeForce GTX 1070\nUsing default input encoding: UTF-8\nLoaded 1 password hash (7z-opencl, 7-Zip [SHA256 AES OpenCL])\nCost 1 (iteration count) is 524288 for all loaded hashes\nCost 2 (padding size) is 7 for all loaded hashes\nCost 3 (compression type) is 2 for all loaded hashes\nWill run 8 OpenMP threads\nPress 'q' or Ctrl-C to abort, almost any other key for status\n0g 0:00:00:15 0.36% (ETA: 00:59:49) 0g/s 3576p/s 3576c/s 3576C/s Dev#2:61°C iiloveyou..simone13\n0g 0:00:11:47 16.93% (ETA: 00:59:03) 0g/s 3736p/s 3736c/s 3736C/s Dev#2:59°C yahoomylove..y2j341\n0g 0:00:19:51 29.15% (ETA: 00:57:34) 0g/s 3643p/s 3643c/s 3643C/s Dev#2:60°C rebel9250..rdoleo\npineapple95 (chicken.7z)\n1g 0:00:21:25 DONE (2021-03-29 00:10) 0.000778g/s 3627p/s 3627c/s 3627C/s Dev#2:59°C pinkice88..pincy\nUse the \"--show\" option to display all of the cracked passwords reliably\nSession completed"]],"language":"Plain Text","wrap":false}],"uri":"https://www.notion.so/1a261c96fac943e0b3147b59e6dce26e","type":"bulleted_list","createdTime":1616989511757,"lastEditedTime":1616991660000,"title":[["Now that we have the password hash, let's crack it using John with the rockyou.txt wordlist:"]]},{"children":[{"children":[],"uri":"https://www.notion.so/75d28c5a440e423eb31d3f062be487ca","type":"text","createdTime":1616992320000,"lastEditedTime":1616992320000,"title":[["pineapple95",[["c",null]]]]}],"uri":"https://www.notion.so/f7596361df714cd6842c800628f0fd7a","type":"bulleted_list","createdTime":1616989511757,"lastEditedTime":1616992380000,"title":[["After 21 gruelling minutes, we get the cracked password:"]]},{"children":[{"children":[],"uri":"https://www.notion.so/933dd4e786534af6bbf41a85bbdf13fb","type":"text","createdTime":1616992380000,"lastEditedTime":1616992380000,"title":[["$ 7z x chicken.7z",[["c",null]]]]},{"children":[],"uri":"https://www.notion.so/9dc0bfe785ce4e658e63aa49697f6282","type":"code","createdTime":1616992380000,"lastEditedTime":1616992560000,"title":[["7-Zip [64] 17.03 : Copyright (c) 1999-2020 Igor Pavlov : 2017-08-28\np7zip Version 17.03 (locale=en_AU.UTF-8,Utf16=on,HugeFiles=on,64 bits,8 CPUs x64)\n\nScanning the drive for archives:\n1 file, 186 bytes (1 KiB)\n\nExtracting archive: chicken.7z\n--\nPath = chicken.7z\nType = 7z\nPhysical Size = 186\nHeaders Size = 138\nMethod = LZMA2:12 7zAES\nSolid = -\nBlocks = 1\n\nEnter password (will not be echoed): pineapple95\nEverything is Ok\n\nSize:       37\nCompressed: 186"]],"language":"Plain Text","wrap":false}],"uri":"https://www.notion.so/6da799e4fc0c4b49a56f0f2820d76352","type":"bulleted_list","createdTime":1616989511758,"lastEditedTime":1616992380000,"title":[["Extract the 7z:"]]},{"children":[{"children":[],"uri":"https://www.notion.so/02133979b8814318b0bb932c38309c9c","type":"text","createdTime":1616992440000,"lastEditedTime":1616992440000,"title":[["$ cat secret",[["c",null]]]]},{"children":[],"uri":"https://www.notion.so/839f4b03eb6749ee87e57cbdad579423","type":"code","createdTime":1616992440000,"lastEditedTime":1616992440000,"title":[["VU1BU1N7QF9sIUxfNW03SCFuXzN4N3JAfQo="]],"language":"Plain Text","wrap":false}],"uri":"https://www.notion.so/a7ec1f1c99dc4f5287fa738e326771af","type":"bulleted_list","createdTime":1616989511758,"lastEditedTime":1616992440000,"title":[["The 7z file contains a "],["secret",[["c",null]]],[" file, let's read it:"]]},{"children":[{"children":[],"uri":"https://www.notion.so/60032526b7dd45a58adc63f2e4ce064a","type":"text","createdTime":1616992500000,"lastEditedTime":1616992500000,"title":[["$ echo \"VU1BU1N7QF9sIUxfNW03SCFuXzN4N3JAfQo=\" | base64 -d",[["c",null]]]]},{"children":[],"uri":"https://www.notion.so/eb5a3cd564de40019817264974e6986d","type":"code","createdTime":1616992500000,"lastEditedTime":1616992500000,"title":[["UMASS{@_l!L_5m7H!n_3x7r@}"]],"language":"Plain Text","wrap":false}],"uri":"https://www.notion.so/7a8387c6f550405797d89a70e487a441","type":"bulleted_list","createdTime":1616989511758,"lastEditedTime":1616992500000,"title":[["This string seems to be encoded in base64, as hinted by the "],["=",[["c",null]]],[" padding. Decoding it gives:"]]},{"children":[],"uri":"https://www.notion.so/23e7eb883fbe4c86b3661d0497f5cf7f","type":"bulleted_list","createdTime":1616989511758,"lastEditedTime":1616989500000,"title":[["Winner winner chicken dinner, we got the flag!"]]},{"children":[],"uri":"https://www.notion.so/2eecd86550644438bb0bc8ef59be899c","type":"heading","createdTime":1616989511758,"lastEditedTime":1616992860000,"title":[["Resources"]],"depth":2},{"children":[],"uri":"https://www.notion.so/9e42b0d6f8984c139bcc7849b448aae2","type":"numbered_list","createdTime":1616990580000,"lastEditedTime":1616990580000,"title":[["https://isotropic.org/papers/chicken.pdf",[["a","https://isotropic.org/papers/chicken.pdf"]]]]},{"children":[],"uri":"https://www.notion.so/36385b26e5b941dc968d790106e46c6c","type":"numbered_list","createdTime":1616989511758,"lastEditedTime":1616992260000,"title":[["http://myexperimentswithmalware.blogspot.com/2014/09/pdf-analysis-with-peepdf.html",[["a","http://myexperimentswithmalware.blogspot.com/2014/09/pdf-analysis-with-peepdf.html"]]]]},{"children":[],"uri":"https://www.notion.so/404e02727d1d4311af8006bb44766ace","type":"numbered_list","createdTime":1616992260000,"lastEditedTime":1616992260000,"title":[["https://en.wikipedia.org/wiki/List_of_file_signatures",[["a","https://en.wikipedia.org/wiki/List_of_file_signatures"]]]]},{"children":[],"uri":"https://www.notion.so/9744ca24799b4e5eba4bd3f1a392d92b","type":"numbered_list","createdTime":1616992200000,"lastEditedTime":1616992200000,"title":[["https://www.7-zip.org/recover.html",[["a","https://www.7-zip.org/recover.html"]]]]}],"uri":"https://www.notion.so/daadf237e2864501a4bd62f87350c2d7","type":"page","createdTime":1616989080000,"lastEditedTime":1617020940000,"title":[["Chicken - UMassCTF '21"]],"icon":"🐔","fullWidth":true,"coverPosition":1,"properties":{"!`\"w":[["Yes"]],"'2]%":[["chicken"]],"98uZ":[["Chicken Chicken Chicken: Chicken Chicken? A forensics category challenge all about extracting hidden streams in a PDF file and 7-Zip password cracking."]],":H`m":[["Yes"]],"xY$N":[["‣",[["d",{"type":"datetime","time_zone":"Australia/Adelaide","start_date":"2021-03-29","start_time":"14:15"}]]]],"{iD?":[["UMassCTF'21,Forensics,Password Cracking"]],"|Ay0":[["post"]],"title":[["Chicken - UMassCTF '21"]]}}